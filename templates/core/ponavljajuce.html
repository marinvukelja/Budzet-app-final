{% extends "base.html" %}
{% block content %}
<h2 class="h4 mb-3">Ponavljajuće transakcije</h2>

<div class="card shadow-sm">
  <div class="card-body">
    <h3 class="h6">Dodaj ponavljajuću transakciju</h3>
    <form method="post">{% csrf_token %}
      {{ form.as_p }}
      <button class="btn btn-success">Spremi</button>
    </form>
  </div>
</div>

<div class="card mt-4 shadow-sm">
  <div class="card-body">
    <h3 class="h6">Moje ponavljajuće transakcije</h3>
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead>
          <tr>
            <th>Opis</th>
            <th>Kategorija</th>
            <th>Iznos</th>
            <th>Frekvencija</th>
            <th>Sljedeći datum</th>
            <th>Status</th>
            <th>Akcije</th>
          </tr>
        </thead>
        <tbody>
          {% for transakcija in items %}
            <tr>
              <td>{{ transakcija.opis }}</td>
              <td>{{ transakcija.kategorija.naziv }}</td>
              <td>{{ transakcija.iznos|floatformat:2 }} €</td>
              <td>{{ transakcija.get_frekvencija_display }}</td>
              <td>{{ transakcija.sljedeci_datum }}</td>
              <td>
                {% if transakcija.aktivno %}
                  <span class="badge bg-success">Aktivno</span>
                {% else %}
                  <span class="badge bg-secondary">Neaktivo</span>
                {% endif %}
              </td>
              <td>
                <a href="{% url 'process_recurring' %}" class="btn btn-sm btn-outline-primary">
                  Obrađuj
                </a>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="7" class="text-muted">Nema ponavljajućih transakcija — dodaj prvu.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="mt-3">
  <a href="{% url 'process_recurring' %}" class="btn btn-primary">
    ⚡ Obrađuj sve dospjele transakcije
  </a>
</div>
{% endblock %}
